# 🎵 讯飞特色发音人小露配置指南

## 📋 前提条件

### 1. 在讯飞控制台申请特色发音人权限
1. **登录讯飞控制台**: https://console.xfyun.cn/services/tts
2. **切换到"特色发音人"标签页**
3. **找到"讯飞小露"发音人**
4. **点击"领取免费发音人"** (如果显示)
5. **确认开通状态**: 状态应显示为"已开通"

### 2. 检查当前权限状态
在控制台中确认：
- ✅ 基础发音人: 已开通
- ✅ 特色发音人: 已开通  
- ✅ 讯飞小露: 状态为"已开通"

## 🔧 技术配置

### 当前后端配置
```javascript
business: { 
    aue: 'lame',           // MP3格式
    vcn: 'x2_xiaolu',      // 特色发音人小露标识
    reg: '2',              // 特色发音人标识
    tte: 'UTF8',
    speed: 45,             // 语速适中
    volume: 85,            // 音量偏大
    pitch: 50              // 标准音调
}
```

### 可能的语音标识变化
特色发音人小露可能的vcn值：
- `x2_xiaolu` (推荐)
- `x_xiaolu` 
- `xiaolu_emo` 
- `premium_xiaolu`

## 🚨 常见问题排查

### 问题1: 权限未开通
**症状**: API返回权限错误
**解决方案**: 
1. 在控制台确认特色发音人已开通
2. 可能需要实名认证和资质审核
3. 联系讯飞客服开通权限

### 问题2: 语音标识错误
**症状**: 返回默认语音或错误
**解决方案**:
1. 尝试不同的vcn值
2. 检查是否需要reg参数
3. 查看讯飞最新文档

### 问题3: 调用配额限制
**症状**: 请求失败或限流
**解决方案**:
1. 检查控制台配额使用情况
2. 升级套餐或购买更多配额
3. 优化调用频率

## 📊 测试步骤

### 1. 后端API测试
```bash
curl -X POST https://memoir-backend-production-b9b6.up.railway.app/api/tts \
  -H "Content-Type: application/json" \
  -d '{"text": "您好，我是特色发音人小露，很高兴为您服务"}'
```

### 2. 前端日志检查
期望看到的日志：
```
📊 AI音频数据大小: xxx bytes, 类型: audio/mpeg
🎵 音频格式: audio/mpeg, 数据大小: xxx bytes
🎵 小露AI语音播放成功！
✅ 使用AI语音服务播放成功
```

### 3. 语音质量验证
- 🎵 **音色**: 应该是温和自然的女声
- 🎵 **语调**: 比基础发音人更加自然
- 🎵 **情感**: 特色发音人具有更丰富的情感表达

## 🔄 备选方案

如果特色发音人小露暂时无法使用：

### 方案1: 其他特色发音人
```javascript
vcn: 'x2_xiaoyan'  // 特色发音人小燕
vcn: 'x2_xiaofeng' // 特色发音人小峰
```

### 方案2: 回退到基础发音人
```javascript
vcn: 'xiaolu'      // 基础发音人小露
reg: '0'           // 或者移除reg参数
```

## 📞 技术支持

### 联系方式
- **讯飞官方文档**: https://doc.xfyun.cn/tts/
- **控制台**: https://console.xfyun.cn/services/tts
- **技术支持**: 通过控制台提交工单

### 检查清单
- [ ] 讯飞控制台已开通特色发音人权限
- [ ] Railway环境变量配置正确
- [ ] 后端vcn参数使用正确的特色发音人标识
- [ ] API调用配额充足
- [ ] 前端expo-av库已正确安装

---

**注意**: 特色发音人可能需要额外的审核和开通流程，请确保在控制台中状态为"已开通"后再进行测试。 